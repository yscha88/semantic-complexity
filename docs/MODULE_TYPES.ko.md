# ëª¨ë“ˆ íƒ€ì… ë¶„ë¥˜ ì²´ê³„

## ê°œìš”

ëª¨ë“ˆ íƒ€ì…ë³„ë¡œ ğŸğŸ§€ğŸ¥“ canonical ratioê°€ ë‹¤ë¥´ë‹¤.
ì´ê²ƒì´ Ham Sandwich ê¸°ë°˜ ë³µì¡ë„ ë¶„ì„ì˜ í•µì‹¬ì´ë‹¤.

```
í˜„ì¬ ì¸¡ì •ê°’ vs Canonical Ratio â†’ í¸ì°¨ â†’ ë¦¬íŒ©í† ë§ ë°©í–¥
```

---

## ë¶„ë¥˜ ì²´ê³„

### 1ì°¨: êµ¬ì¡° ì¶• (Structural Axis)

ì•„í‚¤í…ì²˜/ê¸°ìˆ ì  ë¶„ë¥˜. ë² ì´ìŠ¤ë¼ì¸ ğŸğŸ§€ğŸ¥“ ê²°ì •.

| 1ì°¨ íƒ€ì… | ì •ì˜ | íŠ¹ì„± |
|----------|------|------|
| `api` | UI ì—†ì´ endpointë§Œ ë…¸ì¶œ | ê²½ê³„ë©´ ì—­í• , ê²€ì¦ ì§‘ì¤‘ |
| `web` | ìì²´ Web UI + endpoint ê°€ëŠ¥ | í”„ë ˆì  í…Œì´ì…˜ + API |
| `app` | í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ | ìƒíƒœ/ë¹„ë™ê¸°/ì›Œí¬í”Œë¡œìš° |
| `job` | ì¼íšŒì„±/ì£¼ê¸°ì  ì‹¤í–‰ | Batch, Cron, Worker |
| `lib` | ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜•íƒœ | ì¬ì‚¬ìš©, ìˆœìˆ˜ì„± ì§€í–¥ |
| `deploy` | ë°°í¬/ì¸í”„ë¼ êµ¬ì„± | ì„ ì–¸ì , ë³´ì•ˆ ì¤‘ì‹¬ |
| `data` | ë°ì´í„°/ìŠ¤í† ë¦¬ì§€ | ìŠ¤í‚¤ë§ˆ, ë§ˆì´ê·¸ë ˆì´ì…˜ |

### 2ì°¨: ë„ë©”ì¸ ì¶• (Domain Axis)

ë¹„ì¦ˆë‹ˆìŠ¤/ì»¨í…ìŠ¤íŠ¸ ë¶„ë¥˜. ë² ì´ìŠ¤ë¼ì¸ì—ì„œ ê°€ê°(delta).

---

## ìƒì„¸ ë¶„ë¥˜

### `api` (ê²½ê³„ë©´)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `api/external` | ì™¸ë¶€ ë…¸ì¶œ API (ê³ ê°, 3rd-party) | ğŸâ†‘â†‘ authn/authz, rate limit, audit, ê³„ì•½í…ŒìŠ¤íŠ¸ |
| `api/internal` | ë‚´ë¶€ ì„œë¹„ìŠ¤ê°„ API | ğŸâ†‘ ê³„ì•½ í•„ìš”í•˜ì§€ë§Œ ìœ ì—° |
| `api/gateway` | API Gateway, BFF | ğŸâ†‘â†‘ ë¼ìš°íŒ…, ì¸ì¦ ì§‘ì¤‘ |

### `web` (ì›¹ UI)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `web/public` | ê³µê°œ ì›¹ì‚¬ì´íŠ¸ | ğŸâ†‘ XSS/CSRF, ì ‘ê·¼ì„± |
| `web/admin` | ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ | ğŸâ†‘â†‘ ê¶Œí•œ ê´€ë¦¬, ê°ì‚¬ |
| `web/internal` | ë‚´ë¶€ ë„êµ¬ | ğŸâ†“ ìƒëŒ€ì ìœ¼ë¡œ ìœ ì—° |

### `app` (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `app/workflow` | ìƒíƒœë¨¸ì‹ , saga, orchestration | ğŸ§€â†‘â†‘â†‘ retry/timeout, ë§¥ë½ë°€ë„ í­ë°œ |
| `app/adapter` | ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ê²° (PACS/EHR/S3) | ğŸ§€â†‘ hidden coupling ìœ„í—˜ |
| `app/service` | ì¼ë°˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„œë¹„ìŠ¤ | ê· í˜• |

### `job` (ë°°ì¹˜/ì‘ì—…)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `job/batch` | ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ | ğŸ§€â†‘ ìƒíƒœ ê´€ë¦¬, ì¬ì‹œì‘ |
| `job/cron` | ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ ì‘ì—… | ğŸ§€â†‘ ë©±ë“±ì„± í•„ìš” |
| `job/worker` | í ê¸°ë°˜ ë¹„ë™ê¸° ì›Œì»¤ | ğŸ§€â†‘ retry, dead letter |
| `job/migration` | ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ | ğŸâ†‘ ë¡¤ë°±, ê²€ì¦ |

### `lib` (ë¼ì´ë¸ŒëŸ¬ë¦¬)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `lib/domain` | ë„ë©”ì¸ ê·œì¹™, ì •ì±…, ê²€ì¦ | ğŸ¥“â†‘â†‘ ìˆœìˆ˜, í…ŒìŠ¤íŠ¸ ìš©ì´ |
| `lib/infra` | ê³µìš© í´ë¼ì´ì–¸íŠ¸, ë¯¸ë“¤ì›¨ì–´ | ğŸâ†‘ ë³´ì•ˆ ìœ í‹¸ í¬í•¨ |
| `lib/ai-imaging` | DICOM, preprocessing, inference | ğŸ§€â†‘ ìƒíƒœ/IO í˜¼í•© ìœ„í—˜ |
| `lib/common` | ê³µìš© ìœ í‹¸ë¦¬í‹° | ğŸ¥“â†‘ ìˆœìˆ˜ í•¨ìˆ˜ ì§€í–¥ |

### `deploy` (ë°°í¬/ì¸í”„ë¼)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `deploy/cluster` | ingress, cert-manager, netpol | ğŸâ†‘â†‘â†‘ ì¸í”„ë¼ ë³´ì•ˆ |
| `deploy/app` | values, env, secret refs, HPA | ğŸâ†‘â†‘ ì•± ë°°í¬ êµ¬ì„± |
| `deploy/security` | mTLS, PKI, IAM/RBAC, OPA | ğŸâ†‘â†‘â†‘ ë³´ì•ˆ ì •ì±… |
| `deploy/ci-cd` | íŒŒì´í”„ë¼ì¸, ë¹Œë“œ êµ¬ì„± | ğŸâ†‘ ê³µê¸‰ë§ ë³´ì•ˆ |

### `data` (ë°ì´í„°)

| 2ì°¨ íƒ€ì… | ì •ì˜ | ğŸğŸ§€ğŸ¥“ íŠ¹ì„± |
|----------|------|-------------|
| `data/schema` | DB ìŠ¤í‚¤ë§ˆ, í…Œì´ë¸” ì •ì˜ | ğŸâ†‘ ë°ì´í„° ë¬´ê²°ì„± |
| `data/migration` | ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ | ğŸâ†‘ ğŸ¥“â†‘ ë¡¤ë°±, ê²€ì¦ |
| `data/seed` | ì´ˆê¸°/í…ŒìŠ¤íŠ¸ ë°ì´í„° | ğŸ¥“â†‘ ì¬í˜„ì„± |
| `data/etl` | ë°ì´í„° íŒŒì´í”„ë¼ì¸ | ğŸ§€â†‘ ìƒíƒœ/ë³€í™˜ |

---

## ê°€ì¤‘ì¹˜ êµ¬ì¡°

### ë² ì´ìŠ¤ë¼ì¸ + Delta ë°©ì‹

```
ìµœì¢… ê°€ì¤‘ì¹˜ = 1ì°¨ ë² ì´ìŠ¤ë¼ì¸ + 2ì°¨ Delta

ì˜ˆì‹œ:
  api (1ì°¨ ë² ì´ìŠ¤)     â†’ ğŸ 45 / ğŸ§€ 25 / ğŸ¥“ 30
  + external (2ì°¨ delta) â†’ ğŸ +10
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  api/external (ìµœì¢…)   â†’ ğŸ 55 / ğŸ§€ 20 / ğŸ¥“ 25  (ì •ê·œí™”)
```

### 1ì°¨ ë² ì´ìŠ¤ë¼ì¸ (TBD)

> âš ï¸ êµ¬ì²´ì  ìˆ˜ì¹˜ëŠ” ê·œì œ ê¸°ì¤€ ë° ê²½í—˜ì  ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ê²°ì • ì˜ˆì •

| 1ì°¨ íƒ€ì… | ğŸ Bread | ğŸ§€ Cheese | ğŸ¥“ Ham | ê·¼ê±° |
|----------|----------|-----------|--------|------|
| `api` | ? | ? | ? | TBD |
| `web` | ? | ? | ? | TBD |
| `app` | ? | ? | ? | TBD |
| `job` | ? | ? | ? | TBD |
| `lib` | ? | ? | ? | TBD |
| `deploy` | ? | ? | ? | TBD |
| `data` | ? | ? | ? | TBD |

### 2ì°¨ Delta (TBD)

> âš ï¸ ê° ë„ë©”ì¸ ì¶•ì—ì„œ ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„ ê°€ê°

---

## ê°€ì¤‘ì¹˜ ê²°ì • ê¸°ì¤€ (ì°¸ì¡°)

ê°€ì¤‘ì¹˜ëŠ” ë‹¤ìŒ ê¸°ì¤€ì„ ì°¸ì¡°í•˜ì—¬ ê²°ì •:

### ê·œì œ/í‘œì¤€
- FDA Cybersecurity Guidance (ì˜ë£Œê¸°ê¸°)
- HIPAA (ì˜ë£Œ ë°ì´í„°)
- SOC 2 Type II
- ISO 27001
- OWASP ASVS

### ë„ë©”ì¸ íŠ¹ì„±
- ê²½ê³„ë©´ ë…¸ì¶œ ì •ë„
- ë°ì´í„° ë¯¼ê°ë„ (PHI/PII)
- ê°€ìš©ì„± ìš”êµ¬ì‚¬í•­
- ê°ì‚¬ ìš”êµ¬ì‚¬í•­

### ê¸°ìˆ  íŠ¹ì„±
- ìƒíƒœ ë³µì¡ë„
- ë¹„ë™ê¸°/ë™ì‹œì„±
- ì™¸ë¶€ ì˜ì¡´ì„±
- ë³€ê²½ ë¹ˆë„

---

## í™•ì¥

### ì»¤ìŠ¤í…€ ëª¨ë“ˆ íƒ€ì…

`.semantic-complexity.yaml`ì—ì„œ ì •ì˜:

```yaml
architecture_roles:
  # 1ì°¨ ì¶”ê°€
  ml:
    baseline:
      bread: 20
      cheese: 50
      ham: 30

  # 2ì°¨ ì¶”ê°€
  lib/ml-inference:
    parent: lib
    delta:
      cheese: +15
    patterns:
      - "**/inference/**"
      - "**/models/**"
```

---

## ë¶„ì„ ì œì™¸ ëŒ€ìƒ

### ì œì™¸ ëª¨ë“ˆ íƒ€ì…

ë³µì¡ë„ ë¶„ì„ì—ì„œ ì œì™¸ë˜ëŠ” ëª¨ë“ˆ íƒ€ì…:

| ëª¨ë“ˆ íƒ€ì… | ì •ì˜ | ì œì™¸ ì‚¬ìœ  |
|----------|------|----------|
| `test` | í…ŒìŠ¤íŠ¸ ì½”ë“œ | ğŸ¥“ Ham ê³„ì‚°ì—ë§Œ ì‚¬ìš©, ë³µì¡ë„ ì¸¡ì • ë¶ˆí•„ìš” |
| `config` | ì„¤ì • íŒŒì¼ | ì„ ì–¸ì , ë¡œì§ ì—†ìŒ |
| `types` | íƒ€ì… ì •ì˜ë§Œ | êµ¬ì¡° ì •ì˜, ì‹¤í–‰ ë¡œì§ ì—†ìŒ |
| `generated` | ìë™ ìƒì„± ì½”ë“œ | protobuf, openapi ë“± ìˆ˜ì • ë¶ˆê°€ |
| `script` | ì¼íšŒì„± ìŠ¤í¬ë¦½íŠ¸ | ìœ ì§€ë³´ìˆ˜ ëŒ€ìƒ ì•„ë‹˜ |
| `vendor` | ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³µì‚¬ë³¸ | ìš°ë¦¬ ì½”ë“œ ì•„ë‹˜ |

```python
# tests/test_user.py
__architecture_role__ = "test"

# src/config/settings.py
__architecture_role__ = "config"

# src/types/user.py
__architecture_role__ = "types"

# src/generated/api_pb2.py
__architecture_role__ = "generated"
```

### ìˆ¨ê²¨ì§„ ì˜ì¡´ì„± í—ˆìš© ëª©ë¡

ë‹¤ìŒ íŒ¨í„´ì€ ìˆ¨ê²¨ì§„ ì˜ì¡´ì„± ê³„ì‚°ì—ì„œ **ì œì™¸**:

| íŒ¨í„´ | ì–¸ì–´ | ì œì™¸ ì‚¬ìœ  |
|------|------|----------|
| `logging.*`, `logger.*` | Python | ê´€ì¸¡ì„± í•„ìˆ˜ |
| `print()` | Python | ë””ë²„ê¹… |
| `console.log()`, `console.*` | JS/TS | ë””ë²„ê¹… |
| `log.*`, `slog.*` | Go | ê´€ì¸¡ì„± í•„ìˆ˜ |
| `assert` | ê³µí†µ | ê²€ì¦ ë¡œì§ |
| `raise`, `throw` | ê³µí†µ | ì˜ˆì™¸ ì²˜ë¦¬ |
| `@dataclass`, `TypedDict` | Python | íƒ€ì… ì„ ì–¸ |
| `interface`, `type` | TS | íƒ€ì… ì„ ì–¸ |

### ì„¤ì • íŒŒì¼

```yaml
# .semantic-complexity.yaml
exclude:
  # ë¶„ì„ ì œì™¸ ëª¨ë“ˆ íƒ€ì…
  architecture_roles:
    - test
    - config
    - types
    - generated
    - script
    - vendor

  # ìˆ¨ê²¨ì§„ ì˜ì¡´ì„± í—ˆìš© ëª©ë¡
  hidden_dependency_allowlist:
    - logging
    - logger
    - print
    - console.log
    - console.error
    - console.warn
    - log.Info
    - log.Error
    - slog.*

  # íŒŒì¼ íŒ¨í„´ ì œì™¸
  file_patterns:
    - "**/__generated__/**"
    - "**/node_modules/**"
    - "**/vendor/**"
    - "**/*.pb.go"
    - "**/*_pb2.py"
```

---

## ëª…ì‹œì  ì„ ì–¸ ê·œì¹™

### ì›ì¹™

ëª¨ë“ˆ íƒ€ì…ì€ **ëª…ì‹œì ìœ¼ë¡œ ì„ ì–¸**ë˜ì–´ì•¼ í•œë‹¤.

- âŒ ê²½ë¡œ/ë‚´ìš© ê¸°ë°˜ ì¶”ì • (inference)
- âœ… íŒŒì¼ ìƒë‹¨ì— ëª…ì‹œì  ì„ ì–¸

### ì–¸ì–´ë³„ ì„ ì–¸ ë°©ì‹

#### Python

```python
__architecture_role__ = "api/external"

def create_user():
    ...
```

#### TypeScript / JavaScript

```typescript
/** @module api/external */

export function createUser() { ... }
```

ë˜ëŠ”:

```typescript
export const MODULE_TYPE = "api/external" as const;
```

#### Go

```go
// @module-type: api/external
package users

func CreateUser() { ... }
```

#### Java

```java
@ArchitectureRole("api/external")
public class UserController { }
```

#### Rust

```rust
//! @module-type: api/external

pub fn create_user() { ... }
```

### ê·œì¹™

| ê·œì¹™ | ì„¤ëª… |
|------|------|
| íŒŒì¼ ë‹¨ìœ„ | í•œ íŒŒì¼ = í•œ ëª¨ë“ˆ íƒ€ì… |
| íŒŒì¼ ìƒë‹¨ | ëª¨ë“ˆ íƒ€ì… ì„ ì–¸ì€ íŒŒì¼ ìµœìƒë‹¨ì— ìœ„ì¹˜ |
| í•„ìˆ˜ | ë¶„ì„ ëŒ€ìƒ íŒŒì¼ì€ ë°˜ë“œì‹œ ëª¨ë“ˆ íƒ€ì… ì„ ì–¸ í•„ìš” |
| 1ì°¨ë§Œ ê°€ëŠ¥ | `"app"`, `"deploy"` ë“± 1ì°¨ êµ¬ì¡°ì¶•ë§Œ ì„ ì–¸ ê°€ëŠ¥ |
| 2ì°¨ í¬í•¨ ê°€ëŠ¥ | `"api/external"`, `"lib/domain"` ë“± 2ì°¨ê¹Œì§€ ì„ ì–¸ ê°€ëŠ¥ |

### ë¯¸ì„ ì–¸ íŒŒì¼ ì²˜ë¦¬

ëª¨ë“ˆ íƒ€ì…ì´ ì„ ì–¸ë˜ì§€ ì•Šì€ íŒŒì¼ì€:
- ë¶„ì„ ëŒ€ìƒì—ì„œ ì œì™¸
- ë˜ëŠ” ê²½ê³  ì¶œë ¥ í›„ ê¸°ë³¸ê°’ ì ìš© (ì„¤ì • ê°€ëŠ¥)

```yaml
# .semantic-complexity.yaml
undefined_module:
  action: "warn"  # skip | warn | error
  default: "app"  # ê¸°ë³¸ê°’ (warn ì‹œ ì ìš©)
```

---

## ë¬¸ì„œ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| 0.1 | 2025-12-24 | ì´ˆì•ˆ - 1ì°¨/2ì°¨ ë¶„ë¥˜ ì²´ê³„ ì •ì˜ |
| 0.2 | 2025-12-24 | ëª…ì‹œì  ì„ ì–¸ ê·œì¹™ ì¶”ê°€ - ê²½ë¡œ/ë‚´ìš© ê¸°ë°˜ ì¶”ì • íê¸° |
| 0.3 | 2025-12-24 | ë¶„ì„ ì œì™¸ ëŒ€ìƒ ì¶”ê°€ - test/config/types/generated, í—ˆìš© ëª©ë¡ |
